<!DOCTYPE html>


  <html class="light page-post">


<head>
  <meta charset="utf-8">
  
  <title>How to Use *.info File Calculate Branch Coverage | N.Y.</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="CI/CD," />
  

  <meta name="description" content="What is Branch Coverage Branch coverage is a requirement that, for each branch in the program (e.g., if statements, loops), each branch have been executed at least once during testing. (It is sometime">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Use *.info File Calculate Branch Coverage">
<meta property="og:url" content="http://niyaoyao.me/2024/01/17/how-to-use-info-file-to-calculate-branch-coverage/index.html">
<meta property="og:site_name" content="N.Y.">
<meta property="og:description" content="What is Branch Coverage Branch coverage is a requirement that, for each branch in the program (e.g., if statements, loops), each branch have been executed at least once during testing. (It is sometime">
<meta property="og:locale">
<meta property="og:image" content="https://niyaoyao.github.io/images/branch-coverage.png">
<meta property="article:published_time" content="2024-01-16T16:00:00.000Z">
<meta property="article:modified_time" content="2024-01-19T05:50:00.090Z">
<meta property="article:author" content="Niyao">
<meta property="article:tag" content="CI&#x2F;CD">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://niyaoyao.github.io/images/branch-coverage.png">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=c114cbeddx" rel="stylesheet">


  
    
<link rel="stylesheet" href="/css/personal-style.css">

  

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-38189205-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  
  <script type="text/javascript">
	(function(){
	    var bp = document.createElement('script');
	    var curProtocol = window.location.protocol.split(':')[0];
	    if (curProtocol === 'https') {
	        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
	    }
	    else {
	        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
	    }
	    var s = document.getElementsByTagName("script")[0];
	    s.parentNode.insertBefore(bp, s);
	})();
  </script>



  
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

<meta name="generator" content="Hexo 5.4.2"></head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/category/"
            rel="noopener noreferrer"
            target="_self"
            >
            分类
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/tag/"
            rel="noopener noreferrer"
            target="_self"
            >
            标签
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/link/"
            rel="noopener noreferrer"
            target="_self"
            >
            友链
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/atom.xml"
            rel="noopener noreferrer"
            target="_blank"
            >
            RSS
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-is-Branch-Coverage"><span class="toc-text">What is Branch Coverage</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Format-of-lcov-info"><span class="toc-text">Format of lcov.info</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-Calculate-Branch-Coverage"><span class="toc-text">How to Calculate Branch Coverage</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-text">Example</span></a></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-how-to-use-info-file-to-calculate-branch-coverage" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">How to Use *.info File Calculate Branch Coverage</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2024.01.17</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>Niyao</span>
        </span>
      

      


      

      
      <i class="fa fa-eye"></i> 
        <span id="busuanzi_container_page_pv">
           &nbsp热度 <span id="busuanzi_value_page_pv">
           <i class="fa fa-spinner fa-spin"></i></span>℃
        </span>
      
      
    </div>
  </header>

  <div class="article-content">
    
      <h1 id="What-is-Branch-Coverage"><a href="#What-is-Branch-Coverage" class="headerlink" title="What is Branch Coverage"></a>What is Branch Coverage</h1><blockquote>
<p>Branch coverage is a requirement that, for each branch in the program (e.g., if statements, loops), each branch have been executed at least once during testing. (It is sometimes also described as saying that each branch condition must have been true at least once and false at least once during testing.)<br>From <a target="_blank" rel="noopener" href="https://www.cs.odu.edu/~cs252/Book/branchcov.html">https://www.cs.odu.edu/~cs252/Book/branchcov.html</a></p>
</blockquote>
<p><img src="https://niyaoyao.github.io/images/branch-coverage.png" alt=""></p>
<h2 id="Format-of-lcov-info"><a href="#Format-of-lcov-info" class="headerlink" title="Format of lcov.info"></a>Format of lcov.info</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Following  is  a  quick  description of the tracefile format as used by</span><br><span class="line">   genhtml, geninfo and lcov.</span><br><span class="line"></span><br><span class="line">   A tracefile is made up of several human-readable lines of text, divided</span><br><span class="line">   into sections. If available, a tracefile begins with the testname which</span><br><span class="line">   is stored in the following format:</span><br><span class="line"></span><br><span class="line">     TN:&lt;test name&gt;</span><br><span class="line"></span><br><span class="line">   For each source file referenced in the .da file,  there  is  a  section</span><br><span class="line">   containing filename and coverage data:</span><br><span class="line"></span><br><span class="line">     SF:&lt;absolute path to the source file&gt;</span><br><span class="line"></span><br><span class="line">   Following is a list of line numbers for each function name found in the</span><br><span class="line">   source file:</span><br><span class="line"></span><br><span class="line">     FN:&lt;line number of function start&gt;,&lt;function name&gt;</span><br><span class="line"></span><br><span class="line">   Next, there is a list of execution counts for each  instrumented  func‐</span><br><span class="line">   tion:</span><br><span class="line"></span><br><span class="line">     FNDA:&lt;execution count&gt;,&lt;function name&gt;</span><br><span class="line"></span><br><span class="line">   This  list  is followed by two lines containing the number of functions</span><br><span class="line">   found and hit:</span><br><span class="line"></span><br><span class="line">     FNF:&lt;number of functions found&gt;</span><br><span class="line">     FNH:&lt;number of function hit&gt;</span><br><span class="line"></span><br><span class="line">   Branch coverage information is stored which one line per branch:</span><br><span class="line"></span><br><span class="line">     BRDA:&lt;line number&gt;,&lt;block number&gt;,&lt;branch number&gt;,&lt;taken&gt;</span><br><span class="line"></span><br><span class="line">   Block number and branch number are gcc internal  IDs  for  the  branch.</span><br><span class="line">   Taken  is either &#x27;-&#x27; if the basic block containing the branch was never</span><br><span class="line">   executed or a number indicating how often that branch was taken.</span><br><span class="line"></span><br><span class="line">   Branch coverage summaries are stored in two lines:</span><br><span class="line"></span><br><span class="line">     BRF:&lt;number of branches found&gt;</span><br><span class="line">     BRH:&lt;number of branches hit&gt;</span><br><span class="line"></span><br><span class="line">   Then there is a list of execution counts  for  each  instrumented  line</span><br><span class="line">   (i.e. a line which resulted in executable code):</span><br><span class="line"></span><br><span class="line">     DA:&lt;line number&gt;,&lt;execution count&gt;[,&lt;checksum&gt;]</span><br><span class="line"></span><br><span class="line">   Note  that  there  may be an optional checksum present for each instru‐</span><br><span class="line">   mented line. The current geninfo implementation uses  an  MD5  hash  as</span><br><span class="line">   checksumming algorithm.</span><br><span class="line"></span><br><span class="line">   At  the  end of a section, there is a summary about how many lines were</span><br><span class="line">   found and how many were actually instrumented:</span><br><span class="line"></span><br><span class="line">     LH:&lt;number of lines with a non-zero execution count&gt;</span><br><span class="line">     LF:&lt;number of instrumented lines&gt;</span><br><span class="line"></span><br><span class="line">   Each sections ends with:</span><br><span class="line"></span><br><span class="line">     end_of_record</span><br><span class="line"></span><br><span class="line">   In addition to the main source code file there  are  sections  for  all</span><br><span class="line">   #included files which also contain executable code.</span><br><span class="line"></span><br><span class="line">   Note that the absolute path of a source file is generated by interpret‐</span><br><span class="line">   ing the contents of the respective .bb file  (see  gcov  (1)  for  more</span><br><span class="line">   information  on  this  file type). Relative filenames are prefixed with</span><br><span class="line">   the directory in which the .bb file is found.</span><br><span class="line"></span><br><span class="line">   Note also that symbolic links to the .bb file will be resolved so  that</span><br><span class="line">   the  actual  file  path  is  used  instead  of the path to a link. This</span><br><span class="line">   approach is necessary for the mechanism to  work  with  the  /proc/gcov</span><br><span class="line">   files.</span><br></pre></td></tr></table></figure>
<h2 id="How-to-Calculate-Branch-Coverage"><a href="#How-to-Calculate-Branch-Coverage" class="headerlink" title="How to Calculate Branch Coverage"></a>How to Calculate Branch Coverage</h2><blockquote>
<p>BRDA:<line number>,<block number>,<branch number>,<taken></p>
</blockquote>
<p>Branch Coverage = Hit Branch Count/(Hit Branch Count + Not Hit Branch Count)</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>If the lcov.info ClassA is as follow.<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BRDA:16,0,0,0</span><br><span class="line">BRDA:16,0,1,2</span><br><span class="line">BRDA:24,0,0,1</span><br><span class="line">BRDA:24,0,1,1</span><br><span class="line">BRDA:27,0,0,0</span><br><span class="line">BRDA:27,0,1,2</span><br><span class="line">BRDA:30,0,0,0</span><br><span class="line">BRDA:30,0,1,2</span><br><span class="line">BRDA:33,0,0,1</span><br><span class="line">BRDA:33,0,1,1</span><br></pre></td></tr></table></figure><br>The incremental branch covers 10 lines of Branch, and the hit results are BRDA:16,0,1,2 BRDA:24,0,0,1 BRDA:24,0,1,1 BRDA:27,0,1,2 BRDA:30,0,1,2 BRDA:33,0,0,1 BRDA:33,0,1,1 For these branches, the branch coverage rate is 7/10 = 70%</p>
<p>If the lcov.info ClassB is as follow.<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BRDA:278,0,0,1</span><br><span class="line">BRDA:278,0,1,0</span><br><span class="line">BRDA:280,0,0,-</span><br><span class="line">BRDA:280,0,1,-</span><br></pre></td></tr></table></figure><br>The incremental branch covers 4 lines of Branch, and the hit result is the branch BRDA:278,0,0,1, then the branch coverage rate is 1/4 = 25%</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BRDA:16,0,0,0</span><br><span class="line">BRDA:16,0,1,2</span><br><span class="line">BRDA:24,0,0,1</span><br><span class="line">BRDA:24,0,1,1</span><br><span class="line">BRDA:27,0,0,0</span><br><span class="line">BRDA:27,0,1,2</span><br><span class="line">BRDA:30,0,0,0</span><br><span class="line">BRDA:30,0,1,2</span><br><span class="line">BRDA:33,0,0,1</span><br><span class="line">BRDA:33,0,1,1</span><br><span class="line">BRDA:278,0,0,1</span><br><span class="line">BRDA:278,0,1,0</span><br><span class="line">BRDA:280,0,0,-</span><br><span class="line">BRDA:280,0,1,-</span><br></pre></td></tr></table></figure>
<p>The <em>Branch Coverage Rate</em> of ClassA and ClassB is not ~0.7+0.25~.</p>
<p>（7+1）/ （10+4）= 8/14 = 57.14%</p>

    
  </div>

</article>


   
  <div class="text-center donation">
    <div class="inner-donation">
      <span class="btn-donation">支持一下</span>
      <div class="donation-body">
        <div class="tip text-center">扫一扫，支持forsigner</div>
        <ul>
        
          <li class="item">
            
              <span>微信扫一扫</span>
            
            <img src="/images/qr-wechat.png" alt="">
          </li>
        
          <li class="item">
            
              <span>支付宝扫一扫</span>
            
            <img src="/images/qr-alipay.png" alt="">
          </li>
        
        </ul>
      </div>
    </div>
  </div>


   
  <div class="box-prev-next clearfix">
    <a class="show pull-left" href="/2024/01/04/shaders-and-glsl/">
        <i class="icon icon-angle-left"></i>
    </a>
    <a class="hide pull-right" href="/">
        <i class="icon icon-angle-right"></i>
    </a>
  </div>




</div>


  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/category/"
              rel="noopener noreferrer"
              target="_self"
              >
              分类
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/tag/"
              rel="noopener noreferrer"
              target="_self"
              >
              标签
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/link/"
              rel="noopener noreferrer"
              target="_self"
              >
              友链
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/atom.xml"
              rel="noopener noreferrer"
              target="_blank"
              >
              RSS
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    

    
    

    

    
    

    

<!-- Gitalk评论插件通用代码 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
<script>
const gitalk = new Gitalk({
  clientID: 'e929305d1df52067f223',
  clientSecret: '465557188fddc6608846e97927bc2fe7a268f141',
  repo: 'blog-comments',
  owner: 'niyaoyao',
  // 在这里设置一下截取前50个字符串, 这是因为 github 对 label 的长度有了要求, 如果超过
  // 50个字符串则会报错.
  // id: location.pathname.split('/').pop().substring(0, 49),
  id: md5(location.pathname),
  admin: ['niyaoyao'],
  // facebook-like distraction free mode
  distractionFreeMode: false
})
gitalk.render('gitalk-container')
</script>
<!-- Gitalk代码结束 -->



  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="//cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</body>
</html>
